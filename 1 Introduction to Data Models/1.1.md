# 数据库

## 概念

- 定义：数据库是按照一定数据模型组织、存储并可共享的数据集合，反映现实世界的某个领域。
- 目标：数据共享、减少冗余、数据一致性与完整性、安全可控、并发与恢复、数据独立性。

## 组成与术语

- DB（数据库）：数据的持久化集合。
- DBMS（数据库管理系统）：管理数据库的软件（MySQL、PostgreSQL 等）。
- DBS（数据库系统）：硬件/OS/DBMS/数据/人员的集合。
- 模式与实例：模式（Schema）是结构定义；实例（Instance）是某时刻的数据。
- 三层模式两层映像：外部/概念/内部模式；外-概、概-内映像实现数据独立性（逻辑/物理）。

## 数据模型层次

- 概念模型：面向业务，ER 模型描述实体/属性/联系与约束。
- 逻辑模型：面向 DBMS，关系模型（表/列/行），通过范式降低冗余。
- 物理模型：面向存储与性能，页/索引/分区/文件布局等实现细节。

#### 子类

是另一个实体的子集，总是依赖于**超级类型**而存在。
超类型的属性适用于其所有子类型。不是父类所有属性能对子类使用。

## SQL 分类

- DDL：CREATE/ALTER/DROP
- DML：SELECT/INSERT/UPDATE/DELETE
- DCL：GRANT/REVOKE
- TCL：COMMIT/ROLLBACK/SAVEPOINT

## 事务与并发

- ACID：原子性、一致性、隔离性、持久性。
- 隔离级别：读未提交、读已提交、可重复读、可串行化。
- 并发异常：脏读、不可重复读、幻读。
- 控制机制：锁（S/X、意向锁、间隙锁）、MVCC、多粒度与死锁处理。

## 索引与存储

- 索引类型：B+Tree（主流）、Hash（等值）、全文/空间。
- 使用要点：高选择性列、最左前缀、覆盖索引、避免函数/隐式转换破坏索引。
- 权衡：加速读、增加写放大与空间开销；需要维护和重建策略。

## 设计与规范化

- 流程：需求→ER 建模→逻辑设计→物理实现→上线与演进。
- 范式：1NF/2NF/3NF/BCNF，降低冗余与更新异常。
- 反规范化：为性能引入冗余（汇总表、冗余列、物化视图）需配合约束/任务保持一致。

## 负载与架构

- OLTP vs OLAP：行存+事务 vs 列存+分析；低延迟 vs 高吞吐。
- 扩展与高可用：读写分离、分区/分片、复制/故障转移、备份与恢复、监控与容量规划。
- 安全：最小权限、数据脱敏、静态/传输加密、审计。

# RDBMS 与 MySQL 概述

- RDBMS（关系型数据库管理系统）

  - 定义：以关系模型（表、行、列）组织数据，使用SQL进行数据定义与操作。
  - 核心特性：模式（Schema）、主外键与约束、ACID 事务、并发控制（锁/多版本）、索引与查询优化。
  - 常见产品：MySQL、PostgreSQL、SQL Server、Oracle 等。
- MySQL

  - 定义：一种开源的 RDBMS，实现了关系模型和 SQL（含方言特性）。
  - 关键点：可插拔存储引擎（InnoDB 为默认，支持事务与外键；MyISAM 已不推荐）、丰富索引（B+Tree、前缀、覆盖索引）、复制与高可用（异步/半同步复制、组复制、InnoDB Cluster）。
  - 典型用途：互联网 OLTP、读多写多场景、快速原型与中小型业务；数据仓库/分析更常配合专用系统使用。

# 主要区别

- 范畴 vs 实现
  - RDBMS 是一类数据库系统的统称；MySQL 是其中的一个具体实现。
- 标准 vs 方言
  - RDBMS 遵循 SQL 标准的思想；MySQL 提供 SQL 方言与特有函数/语法（如 LIMIT、ENGINE 语法）。
- 事务与约束
  - RDBMS 强调 ACID；MySQL 的 ACID 能力主要由 InnoDB 提供（不同引擎能力不同）。
- 存储引擎
  - 多数 RDBMS 使用单一引擎；MySQL 采用可插拔引擎，按场景权衡（几乎总选 InnoDB）。
- 高可用与扩展
  - RDBMS 通用能力包括备份、复制、分片等；MySQL 具体提供主从/组复制、Proxy & Sharding 需借助生态工具。
- 许可与生态
  - RDBMS 既有开源也有商业；MySQL 有社区版（GPL）与企业版（商业支持），生态与资料广泛。

# 何时选 MySQL

- 需要成熟开源、部署简单、事务型负载（OLTP）、良好读写性能与社区支持时。
- 若需要复杂 SQL/标准兼容或强一致与扩展特性，也可评估 PostgreSQL、Oracle、SQL Server 等其他 RDBMS。
